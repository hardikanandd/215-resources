<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Generator" content="Microsoft Word 97">
   <meta name="GENERATOR" content="Mozilla/4.75 [en] (WinNT; U) [Netscape]">
   <title>Configuring and installing spar 1</title>
</head>
<body bgcolor="#ffffff" link="#990000" vlink="#b77e7e" alink="#DDB30B" leftmargin="0" topmargin="0"
marginwidth="0" marginheight="0" align="left" rightmargin="0">


<body link="#0000FF" vlink="#800080">
<b><font face="Arial"><h2>Installing
and Operating ssldump 0.9 Beta 1 on systems running Solaris 2.x</h2></font></b>
<table BORDER CELLSPACING=0 CELLPADDING=4 WIDTH="80%">
<tr>
<td BGCOLOR="#CCDDFF"><p><font size=-1>Applies to the practices:</font>
<p><font size=-1>"<a href="http://www.cert.org/security-improvement/practices/p091.html">Identify
data that characterize systems and aid in detecting signs of suspicious
behavior</a>"</font>

<p><font size=-1>Applicable technologies:</font>
<p><font size=-1>Solaris 2.x; UNIX operating system and derivatives</font>
</td>
</tr>
</table>

<p><b><font face="Arial"><font size=+1>Introduction</font></font></b>
<p><font size=-1><b><font face="Courier New">ssldump </font></b>is an SSLv3
(Secure Socket Layer version 3) / TLS (Transport Layer Security) network
protocol analyzer. Using many of the same principles and features as <b><font face="Courier New">tcpdump</font></b>
(see <a href="http://www.cert.org/security-improvement/implementations/i042.13.html">Installing
and operating tcpdump 3.5.x on systems running Solaris 2.x</a>) and by
using <b><font face="Courier New">libpcap</font></b> (see <a href="http://www.cert.org/security-improvement/implementations/i042.11.html">Installing
libpcap to support network packet tools on systems sunning Solaris 2.x</a>),
<b><font face="Courier New">ssldump</font></b>
identifies TCP (Transmission Control Protocol) connections on the specified
network interface and attempts to interpret them as SSLv3/TLS traffic.
When the analyzer identifies SSLv3/TLS traffic, it decodes the records
and displays them in textual form to standard output (stdout).</font>
<p><font size=-1>When <b><font face="Courier New">ssldump</font></b> is
provided with the appropriate cryptographic ‘keying’ material, the program
will decrypt the connections and display the application data traffic.
This particular feature is beyond the scope of this initial document but
may be detailed in a later document.</font>
<p><font size=-1>This document considers the ordinary use of <b><font face="Courier New">ssldump</font></b>
1) to aid in characterizing system behavior and 2) to act as an aid in
creating awareness of these types of traffic analyzers, by presenting the
functionality and kinds of connection information generated by <b><font face="Courier New">ssldump</font></b>.</font>
<p><font size=-1>As noted by the author’s <a href="http://www.rtfm.com/ssldump/">web
site</a>, the current version is 0.9b1, Patch 1. Additionally, "Patch 1
fixes a number of minor bugs in 0.9b1, including a TCP reassembly bug that
causes core dumps on sequence number wraparound. This is the "string format
vulnerability" discussed on <a href="http://www.securityfocus.com/templates/archive.pike?list=1&mid=150403">bugtraq</a>.
Note that it's not really a string format problem and as far as [the author
knows] can only be used to cause core dumps."</font>
<p><b><font face="Arial"><font size=+1>Effort Estimates</font></font></b>
<p><font size=-1>Time to retrieve the archive file(s) and patches, if available,
from the distribution site will vary depending on connection speed. Expected
time is under a half-minute or less with a T1 connection. Hardening, which
includes building, patching, installing, and testing <b><font face="Courier New">ssldump,
</font></b>should
take between five and ten minutes depending on machine performance and
installation familiarity.</font>
<p><b><font face="Arial"><font size=+1>System Prerequisites</font></font></b>
<p><font size=-1><b><font face="Courier New">ssldump</font></b> can be
built and installed on many UNIX systems. The following list is taken from
the <b><font face="Courier New">ssldump</font></b> developer's <a href="http://www.rtfm.com/ssldump/">web
site</a>:</font>
<p><font size=-1>FreeBSD, Linux, Solaris, and HP/UX (but should compile
and run on any platform with pcap)</font>
<p><b><i><font face="Arial">Software</font></i></b>
<p><font size=-1>To build and run <b><font face="Courier New">ssldump</font></b>
on your system, you need the following access and software tools:</font>
<ul>
<li>
<font size=-1>Internet access to retrieve the software.</font></li>

<li>
<font size=-1>an MD5 cryptographic checksum program (refer to "<a href="/security-improvement/implementations/i002.01.html">Using
MD5 to verify the integrity of file contents</a>").</font></li>

<li>
<font size=-1><a href="http://www.gnu.org/software/gzip/gzip.html">GZIP</a>
to uncompress the downloaded file.</font></li>

<li>
<font size=-1>a C compiler; either the Sun C Computer or the free <a href="http://www.gnu.org/software/gcc/gcc.html">GNU
C Compiler</a>.</font></li>

<li>
<font size=-1>the libpcap library (refer to <a href="http://www.cert.org/security-improvement/implementations/i042.11.html">Installing
libpcap to support network packet capturing tools on systems running Solaris
2.X</a>). <b><font face="Courier New">ssldump</font></b> requires this
interface for low-level packet capturing.</font></li>
</ul>
<font size=-1>Additionally, <b><font face="Courier New">ssldump</font></b>
can be used in conjunction with <b><font face="Courier New">tcpdump</font></b>
captured data (see <a href="http://www.cert.org/security-improvement/implementations/i042.13.html">Installing
and operating tcpdump 3.5.x on systems running Solaris 2.x</a> for information
on how to use <b><font face="Courier New">tcpdump</font></b>).</font>
<br>&nbsp;
<p><b><font size=+1><font face="Arial">Hardening </font><font face="Courier New">ssldump</font></font></b>
<p><font size=-1>Hardening <b><font face="Courier New">ssldump</font></b>
includes downloading the source distribution files, verifying the distribution
has not changed, compiling the distribution for your operating system (building),
testing the program before installation, installing the program, and updating
<b><font face="Courier New">tripwire</font></b>
to account for the additional files.</font>
<p><b><font face="Arial"><font size=+0>Downloading and Verifying</font></font></b>
<p><font size=-1>Download the following files into the same directory (eg.
/tmp) and verify their checksums with an MD5 checksum program.</font>
<br>&nbsp;
<table BORDER CELLPADDING=7 WIDTH="678" >
<tr>
<td VALIGN=TOP WIDTH="58%" HEIGHT="16">
<center><b><font size=-1>File to Download</font></b></center>
</td>

<td VALIGN=TOP WIDTH="42%" HEIGHT="16">
<center><b><font size=-1>MD5 Checksum</font></b></center>
</td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="58%" HEIGHT="16"><font size=-1><a href="http://www.rtfm.com/ssldump/ssldump-0.9b1.tar.gz">http://www.rtfm.com/ssldump/ssldump-0.9b1.tar.gz</a></font></td>

<td VALIGN=TOP WIDTH="42%" HEIGHT="16"><b><font face="Courier New"><font size=-1>ace8f1b4f8bfa4cd494a3e546655c5e7</font></font></b></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="58%" HEIGHT="16"><font size=-1><a href="http://www.rtfm.com/ssldump/patch1">http://www.rtfm.com/ssldump/patch1</a></font></td>

<td VALIGN=TOP WIDTH="42%" HEIGHT="16"><b><font face="Courier New"><font size=-1>799e5c2638639c5250b1937d706a7ddf</font></font></b></td>
</tr>
</table>

<p><font size=-1>If the computed cryptographic checksum of the download
files does not correspond to the information above, verify that:</font>
<ul>
<li>
<font size=-1>your downloaded filenames match those listed above</font></li>

<li>
<font size=-1>your checksum program computes MD5 message digests</font></li>
</ul>
<b><font face="Arial"><font size=+0>Building and Patching</font></font></b>
<p><font size=-1>To build <b><font face="Courier New">ssldump</font></b>,
we recommend using an ordinary user account with less privileges than a
super-user account like 'root'. In fact, you will only need to become super-user
when you run the program, you modify the installation location to install
in a more restrictive location, or you want to modify the access permissions
(ACLs) on the distribution objects. Under these cases you can use the <b><font face="Courier New">su</font></b>
(substitute user) command to step up to a super-user account from an ordinary
user account, but we recommend against using excessively privileged accounts
except when absolutely necessary.</font>
<p><font size=-1>Unpack the <b><font face="Courier New">ssldump</font></b>
distribution with:</font>
<p><font face="Courier New"><font size=-1>$ gunzip –c ssldump-0.9b1.tar.gz
| tar xf –</font></font>
<p><font size=-1>This creates a directory named <i>ssldump-0.9b1</i>. <i>Note:
The following installation commands mirror those found in the ‘INSTALL'
file provided with the distribution and can be viewed with a UNIX editor
such as </i><b><font face="Courier New">vi</font></b><i> or </i><b><font face="Courier New">emacs</font></b>.
Next, copy the patch, <font face="Courier New">patch1,</font> into the
<i>ssldump-0.9b1</i>
directory and then apply the patch, with:</font>
<p><font face="Courier New"><font size=-1>$ patch &lt; patch1</font></font>
<p><font size=-1>For example, if you downloaded<font face="Courier New">
patch1 </font>and <font face="Courier New">ssldump-0.9b1.tar.gz </font>into
the<font face="Courier New"> </font><i>/tmp</i>directory, you would do
the following after the unpacking the distribution as above:</font>
<p><font face="Courier New"><font size=-1>$ cp /tmp/patch1 /tmp/ssldump-0.9b1/</font></font>
<p><font face="Courier New"><font size=-1>$ cd /tmp/ssldump-0.9b1/</font></font>
<p><font face="Courier New"><font size=-1>$ patch &lt; patch1</font></font>
<br>&nbsp;
<br>&nbsp;
<p><font size=-1>Next, use the following command to configure the settings
need for compilation by executing the following:</font>
<p><font face="Courier New"><font size=-1>$ ./configure</font></font>
<p><font size=-1>You should review the Makefile to ensure that there are
no configuration variables set that you do not want as part of the build.
In particular, make sure the specified compiler (for example, cc) is the
one that you want and that the compiler options are set appropriately for
your site. On Solaris 2.x, the defaults should produce a satisfactory build.</font>
<p><font size=-1>Then, build <b><font face="Courier New">ssldump</font></b>
with:</font>
<p><font face="Courier New"><font size=-1>$ make</font></font>
<p><b><font face="Arial"><font size=+0>Testing Before Installation</font></font></b>
<p><font size=-1>Testing before installation is a good way to determine
whether the program was compile correctly. Before you can test <b><font face="Courier New">ssldump</font></b>,
you will need to have super-user privileges because <b><font face="Courier New">ssldump</font></b>
accesses the network interface. Since this function is reserved for privileged
accounts, like 'root', this is an acceptable and necessary time to use
the <b><font face="Courier New">su</font></b> command.</font>
<p><font size=-1>To become the super-user on your system, enter:</font>
<p><font face="Courier New"><font size=-1>$ su -</font></font>
<p><font size=-1>Two things to note here: 1) by default, your prompt should
be indicated by the '#' symbol, and 2) we used the '-' option to acquire
the environmental variables under this user (i.e. root's PATH variable).
Using just the <b><font face="Courier New">su</font></b> would retain the
environmental variable of the account we are substituting from. You should
now be in the root account and at the startup location specified by roots
home directory.</font>
<p><font size=-1>To test the correct operation of <b><font face="Courier New">ssldump</font></b>,
execute <b><font face="Courier New">ssldump</font></b> with the following
options (substituting "le0" with the appropriate interface), as follows:</font>
<p><font face="Courier New"><font size=-1># ./ssldump –i le0 port 433</font></font>
<p><font size=-1>Now open your favorite web browser supporting SSL/TLS
(i.e. Netscape, Internet Explorer) and browse to an SSL/TLS enabled web
site, such as <a href="https://www.cert.org/">https://www.cert.org/</a>.
You should receive output to the terminal (stdout) similar to the following.
<i>Note:
AA.BB.CC.DD represents the source IP address you are connecting from and
www.&lt;some-ssl-site>.com represents the SSL-enabled web server you are
connecting to.</i></font>
<dir>
<dir><b><font face="Courier New"><font size=-1>Kernel filter, protocol
ALL, raw packet socket</font></font></b>
<p><b><font face="Courier New"><font size=-1>New TCP connection #1: AA.BB.CC.EE(2876)
&lt;-> s1.red.cert.org(443)</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 1 0.0034 (0.0034) C>S Handshake</font></font></b>
<p><b><font face="Courier New"><font size=-1>ClientHello</font></font></b>
<p><b><font face="Courier New"><font size=-1>Version 3.0</font></font></b>
<p><b><font face="Courier New"><font size=-1>resume [32]=</font></font></b>
<p><b><font face="Courier New"><font size=-1>cd 78 8e 90 bd c0 c0 80 e6
3f 27 ac ec 7b 61 3d</font></font></b>
<p><b><font face="Courier New"><font size=-1>8d 50 cd a4 66 0a 39 03 11
17 09 7c 64 01 9a 59</font></font></b>
<p><b><font face="Courier New"><font size=-1>cipher suites</font></font></b>
<p><b><font face="Courier New"><font size=-1>SSL_RSA_WITH_RC4_128_MD5</font></font></b>
<p><b><font face="Courier New"><font size=-1>Unknown value 0xfeff</font></font></b>
<p><b><font face="Courier New"><font size=-1>SSL_RSA_WITH_3DES_EDE_CBC_SHA</font></font></b>
<p><b><font face="Courier New"><font size=-1>Unknown value 0xfefe</font></font></b>
<p><b><font face="Courier New"><font size=-1>SSL_RSA_WITH_DES_CBC_SHA</font></font></b>
<p><b><font face="Courier New"><font size=-1>SSL_RSA_EXPORT1024_WITH_RC4_56_SHA</font></font></b>
<p><b><font face="Courier New"><font size=-1>SSL_RSA_EXPORT1024_WITH_DES_CBC_SHA</font></font></b>
<dir>
<dir><b><font face="Courier New"><font size=-1>SSL_RSA_EXPORT_WITH_RC4_40_MD5</font></font></b></dir>
</dir>
<b><font face="Courier New"><font size=-1>SSL_RSA_EXPORT_WITH_RC2_CBC_40_MD5</font></font></b>
<p><b><font face="Courier New"><font size=-1>compression methods</font></font></b>
<p><b><font face="Courier New"><font size=-1>NULL</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 2 0.0052 (0.0017) S>C Handshake</font></font></b>
<p><b><font face="Courier New"><font size=-1>ServerHello</font></font></b>
<p><b><font face="Courier New"><font size=-1>Version 3.0</font></font></b>
<p><b><font face="Courier New"><font size=-1>session_id[32]=</font></font></b>
<p><b><font face="Courier New"><font size=-1>cd 78 8e 90 bd c0 c0 80 e6
3f 27 ac ec 7b 61 3d</font></font></b>
<p><b><font face="Courier New"><font size=-1>8d 50 cd a4 66 0a 39 03 11
17 09 7c 64 01 9a 59</font></font></b>
<p><b><font face="Courier New"><font size=-1>cipherSuite SSL_RSA_WITH_RC4_128_MD5</font></font></b>
<p><b><font face="Courier New"><font size=-1>compressionMethod NULL</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 3 0.0052 (0.0000) S>C ChangeCipherSpec</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 4 0.0052 (0.0000) S>C Handshake</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 5 0.0065 (0.0012) C>S ChangeCipherSpec</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 6 0.0134 (0.0069) C>S Handshake</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 7 0.0134 (0.0000) C>S application_data</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 8 0.0257 (0.0123) S>C application_data</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 9 0.0321 (0.0063) S>C application_data</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 10 0.0351 (0.0030) S>C application_data</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 11 0.0389 (0.0038) S>C application_data</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 12 0.0389 (0.0000) S>C application_data</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 13 0.0389 (0.0000) S>C Alert</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 0.0389 (0.0000) S>C TCP
FIN</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 14 0.2032 (0.1643) C>S Alert</font></font></b>
<p><b><font face="Courier New"><font size=-1>1 0.2035 (0.0002) C>S TCP
FIN</font></font></b></dir>
</dir>
<b><font face="Arial"><font size=+0>Installation</font></font></b>
<p><font size=-1>To install <b><font face="Courier New">ssldump</font></b>
you must be logged in to the 'root' account or have privileges over the
install location. By default, <b><font face="Courier New">ssldump</font></b></font><b>will
install in <i>/usr/local/bin</i>. As a suggested alternative, you should
consider manually installing the compiled files into <i>/usr/local/sbin</i>.
This helps to prevent redirection by the 'make install' sequence, secure
the binary in a more privileged directory, and give you the capability
to personally set permissions. To manually install <font size=-1><font face="Courier New">ssldump</font></font></b><font size=-1>:</font>
<p><font face="Courier New"><font size=-1># cp <i>ssldump </i>/usr/local/sbin/ssldump</font></font>
<p><font face="Courier New"><font size=-1># cp -p ssldump.1 /usr/local/man/man1/ssldump.1</font></font>
<p><font face="Courier New"><font size=-1># cd /usr/local/sbin</font></font>
<p><font face="Courier New"><font size=-1># chmod 550 /usr/local/sbin/ssldump</font></font>
<p><font size=-1>If you choose to automate the installation, installation
location, and permission settings, you can install the binary and manual
pages with:</font>
<p><font face="Courier New"><font size=-1># make install</font></font>
<p><font size=-1>Regardless of the install location, the program should
have ACLs permitting execution by only the 'root' user. Additionally, while
the documentation accompanying <b><font face="Courier New">ssldump</font></b>
indicates that the program may be accessed by other users using a SetUID
to 'root', we recommend against this setting for a more secure implementation.</font>
<p><b><font face="Arial"><font size=+0>Tripwire Configuration</font></font></b>
<p><font size=-1>The following is the <b>tripwire</b> configuration for
the <b><font face="Courier New">ssldump</font></b> program once installed.
Only two files, the <b><font face="Courier New">ssldump</font></b> executable
and <b><font face="Courier New">ssldump</font></b>(1) man page, require
monitoring by <b>tripwire</b>.</font>
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<br>&nbsp;
<p><font size=-1>The following files should not change, as any changes
are unexpected:</font>
<p><font size=-1>@@define BINARY E+pinugsamc1-023456789</font>
<p><font size=-1>/usr/local/sbin/ssldump @@BINARY</font>
<p><font size=-1>/usr/local/man/man1/ssldump.1 @@BINARY</font>
<br>&nbsp;
<p><b><font face="Arial"><font size=+1>Using ssldump</font></font></b>
<p><b><font face="Arial"><font size=+0>Basic Command Use</font></font></b>
<p><font size=-1><b><font face="Courier New">ssldump </font></b>is a command-line
executed program, with many of the same options and expressions capable
under <b><font face="Courier New">tcpdump</font></b> (see <a href="http://www.cert.org/security-improvement/implementations/i042.13.html">Installing
and operating tcpdump 3.5.x on systems running Solaris 2.x</a>). The following
information has been reproduced from the <b><font face="Courier New">ssldump</font 
></b> manual
(man)pages, which accompany the source distribution. The basic command
structure is depicted and then the options and expressions that can be
passed during initialization are explained.
<p><b><font face="Courier New"><font size=-1>ssldump [ -vtaTnsAxXhHVNdq
] [ -r dumpfile ] [ -i interface ]</font></font></b>
<p><b><font face="Courier New"><font size=-1>[ -k keyfile ] [ -p password
] [ expression ]</font></font></b>
<p><b><font face="Arial"><font size=+0>Explanation of Options</font></font></b>
<br>&nbsp;
<table BORDER CELLPADDING=7 WIDTH="638" >
<tr>
<td VALIGN=TOP WIDTH="18%"><b><font size=-1>Options</font></b></td>

<td VALIGN=TOP WIDTH="82%"><b><font size=-1>Description</font></b></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-a</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Print bare TCP ACKs.</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-A</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Print all record fields (by default
ssldump chooses the most interesting fields).</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-d</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Display the application data traffic.
This usually means decrypting it, but when -d is used ssldump will also
decode application data traffic _before_ the SSL session initiates. This
allows you to see HTTPS CONNECT behavior as well as SMTP STARTTLS. As a
side effect, since ssldump can't tell whether plaintext is traffic before
the initiation of an SSL connection or just a regular TCP connection, this
allows you to use ssldump to sniff any TCP connection. ssldump will automatically
detect ASCII data and display it directly to the screen. Non-ASCII data
is displayed as hex dumps. See also -X.</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-e</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Print absolute timestamps instead
of relative timestamps.</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-r</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Read data from file instead of
from the network. The old -f option still works but is deprecated and will
probably be removed with the next version.</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-k</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Use keyfile as the location of
the SSL keyfile (OpenSSL format) ssldump automatically looks in ./server.pem.</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-n</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Don't try to resolve host names
from IP addresses.</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-N</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Attempt to parse ASN.1 when it
appears, such as in certificates and DNs.</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-p</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Use password as the SSL keyfile
password default is "password".</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-q</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Don't decode any record fields
beyond a single summary line (quiet mode).</font></td>
</tr>
</table>

<br>&nbsp;
<table BORDER CELLPADDING=7 WIDTH="638" >
<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-x</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>Print each record in hex, as well
as decoding it.</font></td>
</tr>

<tr>
<td VALIGN=TOP WIDTH="18%"><font face="Courier New"><font size=-1>-X</font></font></td>

<td VALIGN=TOP WIDTH="82%"><font size=-1>When the -d option is used, binary
data is automatically printed in two columns with a hex dump on the left
and the printable characters on the right. -X suppresses the display of
the printable characters, thus making it easier to cut and paste the hex
data into some other program.</font></td>
</tr>
</table>

<br>&nbsp;
<p><b><font face="Arial"><font size=+0>Explanation of Expressions</font></font></b>
<p><font size=-1>The expression option, in the command-line syntax, allows
you to specifically select the types of packets <b><font face="Courier New">ssldump</font></b>
will examine. <b><font face="Courier New">ssldump</font></b> supports the
full expression syntax from <b><font face="Courier New">libpcap</font></b>
and <b><font face="Courier New">tcpdump</font></b>. In fact, the information
provided in the manual pages discussing 'expression' is reproduced from
tcpdump's manual pages.</font>
<p><font size=-1><i>Note: One exception is that most </i><font face="Courier New">tcpdump</font>
expressions will select traffic combinations that <font face="Courier New">ssldump</font>
will simply ignore because <font face="Courier New">ssldump</font> needs
to examine full TCP streams. Therefore, even though ssldump supports full
expression syntax from tcpdump and libpcap, using certain expressions will
yield incomplete and unusable data to ssldump.</font>
<p><font size=-1>For a more information on the specific expressions <b><font face="Courier New">ssldump</font></b>
can use effectively, see the manual pages installed with the distribution,
<b><font face="Courier New">ssldump(1)</font></b>.</font>
<p><b><font face="Arial"><font size=+0>Common Use</font></font></b>
<p><b><font face="Courier New"><font size=-1>ssldump</font></font> </b><font size=-1>may
be implemented to perform real-time SSL/TLS protocol analysis or to process
previously captured network traffic. During real-time capture, <b><font face="Courier New">ssldump</font></b>
may be used to characterize the normal sequence of SSL/TLS traffic and
display features of SSL/TLS connections.</font>
<p><font size=-1>Examples:</font>
<p><font size=-1>To listen to traffic on interface le0 port 443:</font>
<dir>
<dir><font face="Courier New"><font size=-1># ssldump -i le0 port 443</font></font></dir>
</dir>
<font size=-1>To listen to specific bound for the server romeo on port
443:</font>
<dir>
<dir><font face="Courier New"><font size=-1># ssldump -i le0 port 443 and
host romeo</font></font></dir>
</dir>
<font size=-1>To analyze previously captured <b><font face="Courier New">tcpdump</font></b>
records (from the file /tmp/tcpdumped.txt):</font>
<dir>
<dir><font face="Courier New"><font size=-1># ssldump -r /tmp/tcpdumped.txt</font></font></dir>
</dir>
<b><font face="Arial"><font size=+0>Understanding Output</font></font></b>
<p><font size=-1>This section is an introduction to understanding the output
from <b><font face="Courier New">ssldump</font></b>. Quite a bit of information
can be gleaned from this tool but that information centers around two primary
areas: 1) TCP connection setup, 2) SSL/TLS records, record types, and data.</font>
<p><font size=-1><u>TCP connection setup output</u>.</font>
<p><font size=-1>Each TCP connection is logged by <b><font face="Courier New">ssldump</font></b>
and uniquely indicated to separate each connection from others and other
special traffic information. To keep things simple, most traffic displayed
on a connection line depicts the SSL client information on the left with
SSL server information on the right. For example:</font>
<dir>
<dir><font face="Courier New"><font size=-1>New TCP connection #1: AA.BB.CC.DD(2876)
&lt;-> www.&lt;some-ssl-site>.com(443)</font></font>
<br>&nbsp;</dir>
</dir>
<font size=-1>Shows a new TCP session being setup between the SSL client
AA.BB.CC.DD and the SSL server at www.&lt;some-ssl-site>.com. Additionally
the SSL client's source port is 2876 and is attempting a connection on
the SSL server's destination port, which is 433. The unique indicator for
this connection is denoted by #1, which in our case means that this is
the first connection logged. Sequentially, additional connections will
be incremented to #2, #3, #4, etc.</font>
<p><font size=-1><u>SSL/TLS records, types, and data</u>.</font>
<p><font size=-1>The actual SSL dialog resides within the record lines,
containing: the connection number, the record number, the timestamps, the
direction of traffic data, and the record type (holding additional information).
For example:</font>
<dir>
<dir><font face="Courier New"><font size=-1>1 1 0.0699 (0.0699) C>S SSLv2
compatible client hello</font></font></dir>
</dir>
<font size=-1>shows:</font>
<ul>
<ul>
<li>
<font size=-1>connection #: 1</font></li>

<li>
<font size=-1>record #: 1</font></li>

<li>
<font size=-1>timestamp of 'time since beginning connection #1': 0.0669</font></li>

<li>
<font size=-1>timestamp of 'time since previous record for connection #1':
0.0699</font></li>

<li>
<font size=-1>direction of record: C>S (in this case, client to server)</font></li>

<li>
<font size=-1>record type: "SSLv2 compatible client hello"</font></li>
</ul>
</ul>
<font size=-1>Record type indicates specific types of record data being
captured:</font>
<ul>
<ul>
<li>
<font size=-1>Handshake sequence steps (Handshake)</font></li>

<li>
<font size=-1>Indications of alerts (Alert)</font></li>

<li>
<font size=-1>Changes in cipher specifications (ChangeCipherSpec)</font></li>

<li>
<font size=-1>Presence of application data (application_data)</font></li>

<li>
<font size=-1>Termination of connections (TCP FYN)</font></li>
</ul>
</ul>

<p><b><font face="Arial"><font size=+0>Integration with Other Administrative
Tasks</font></font></b>
<p><font size=-1>When used with other administrative functions and security
tasks, <b><font face="Courier New">ssldump</font></b> can</font>
<ol>
<ol>
<li>
<font size=-1>indicate a security event may have happened by displaying
inappropriate tunneling setup and use (i.e. <b><font face="Courier New">ssldump</font></b>
records that an SSL session was setup to an outside SSL-enabled server
but no information is given to support the tunnel is encrypting traffic).</font></li>

<li>
<font size=-1>identify discrepancies between reported connections under
tcpdump and other network traffic analyzers, when output is compared across
several tools.</font></li>

<li>
<font size=-1>be used to correlate the certificate and encryption information
provided by a web browser.</font></li>

<li>
<font size=-1>identify potential security policy issues (i.e. encrypted
content is unable to be inspected by your intrusion detection system).</font></li>
</ol>
</ol>
<b><font face="Arial"><font size=+1>Acknowledgements</font></font></b>
<p><font size=-1>The author would like to thank the developer(s) of <b><font face="Courier New">ssldump</font></b>
and the author of the <b><font face="Courier New">ssldump</font></b> web
site. Many of the examples and documentation were reproduced in part and
can be directly attributed to the developer's information as posted on
the <a href="http://www.rtfm.com/ssldump/">web site</a> or within the source
distribution.</font>
</body>
</html>

<html>
<head>
<title>Configuring and using syslogd</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body bgcolor="#ffffff" link="#990000" vlink="#b77e7e" alink="#DDB30B" leftmargin="0" topmargin="0"
marginwidth="0" marginheight="0" align="left" rightmargin="0">



<font face="Helvetica, Geneva, Arial">
<small>
<table width="100%" cellpadding="4" cellspacing="4">
  <tr valign="top"> 
    <td width="126"><b><font face="Arial" color="#000000">Implementation Details</font></b></td>
    <td><b><font face="Arial" size=4>Configuring and using syslogd to collect 
      logging messages on systems running Solaris 2.x </font></b></td>
  </tr>
  <tr valign="top"> 
    <td width="126">&nbsp;</td>
    <td> 
      <table border="1" width="75%" cellspacing="0" cellpadding="8" bgcolor="#ccddff">
        <tr> 
          <td align="LEFT" valign="TOP"> 
            <p>Applies to the practices:<br>
<a href="../practices/p095.html">"Monitor and inspect system activities for unexpected behavior"</a><br> 
<a href="../practices/p091.html">"Identify data that characterize systems and aid in detecting signs of suspicious behavior"</a> 
<br><a href="../practices/p092.html">"Manage logging and other data collection mechanisms"</a></p>
            <p>Applicable technologies: Solaris 2.x; UNIX operating system and 
              derivatives </p>
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126">&nbsp;</td>
    <td> 
      <p> </p>
      <p><font face="Courier New" size=3>Syslogd </font>(8) is a collecting mechanism 
        for various logging messages generated by the kernel and applications 
        running on UNIX operating systems. </p>
      <p>Although this daemon is installed by default, its configuration should 
        be adjusted to specify what messages are to be stored in what files or 
        forwarded to another loghost on the local network. The default <font face="Courier New" size=3>syslogd</font> 
        configuration usually does not reflect the full set of installed application 
        programs and does not support the desired logging priorities. </p>
      <p>This section describes how to configure and use syslogd on the Sun Solaris 
        operating system, version 2.x. </p>
    </td>
  </tr>
  <tr valign="top"> 
    <td colspan="2"> 
      <hr size="1">
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126"><b> 
      <p><font face="Arial" color="#000000">Understand the </font><font face="Courier New" size="3" color="#000000">syslog</font><font face="Arial" size="3" color="#000000"> 
        </font><font face="Arial" color="#000000">function</font></p>
      </b> </td>
    <td> 
      <p>Every message handed over to <font face="Courier New" size=3>syslogd</font> 
        is assigned a level of importance, consisting of the facility - the system 
        component from which the message originated, e.g., the mail system - and 
        the priority - the severity of the message, e.g., a warning. The configuration 
        lists combinations of priority and facility and specifies actions related 
        to these combinations.</p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td align="right" width="126"></td>
    <td> 
      <p><b><font face="Arial" size="3" color="#008000">Understand facilities 
        and priorities.</font></b></p>
      <p> </p>
      <p>Based on its configuration, <font face="Courier New" size=3>syslogd </font>performs 
        a given action for all messages with a specified priority (or higher) 
        and facility (see tables below). By using the facility, messages generated 
        by different system components can be logged with different priorities. 
      </p>
      <p>The values of both parameters (priority, facility) are described in detail 
        on the <font face="Courier New" size=3>syslog</font> (3) man page as shown 
        below: </p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126">&nbsp;</td>
    <td> 
      <table border cellspacing=1 cellpadding=7 width=75%>
        <tr> 
          <td width="20%" valign="TOP" bgcolor="#ccddff" align="LEFT"> 
            <p><b>Facility </b> 
          </td>
          <td width="80%" valign="TOP" bgcolor="#ccddff" align="LEFT"> 
            <p><b>Description </b> 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>auth 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Used by authorization systems (login) 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>cron 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Used for the cron and at systems 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>daemon 
          </td>
          <td width="80%" valign="TOP"> 
            <p>System/network daemons 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>kern 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Produced by kernel messages 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>lpr 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Printing system 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>mail 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Mail system 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>mark 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Internally used for time stamps 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>news 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Reserved for the news system 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>user 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Default facility, used for any program 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>uucp 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Reserved for the uucp system 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>local0..7 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Reserved for local use 
          </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126">&nbsp;</td>
    <td width="633">Priorities are listed from lowest to highest as shown below: 
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126">&nbsp;</td>
    <td> 
      <table border cellspacing=1 cellpadding=7 width=75%>
        <tr> 
          <td width="20%" valign="TOP" bgcolor="#ccddff" align="LEFT"> <b> 
            <p>Priority 
            </b></td>
          <td width="80%" valign="TOP" bgcolor="#ccddff" align="LEFT"> <b> 
            <p>Description 
            </b></td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>debug 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Normally used for debugging 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>info 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Informational messages 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>notice 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Conditions that may require attention 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>warning 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Any warnings 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>err 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Any errors 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>crit 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Critical conditions like hardware problems 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>alert 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Any condition that demand immediate attention 
          </td>
        </tr>
        <tr> 
          <td width="20%" valign="TOP"> 
            <p>emerg 
          </td>
          <td width="80%" valign="TOP"> 
            <p>Any emergency condition 
          </td>
        </tr>
      </table>
    <p>&nbsp;</p></td>
  </tr>
  <tr valign="top"> 
    <td align="right" width="126"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Understand the associated actions.</p>
      </font></b> 
      <p> </p>
      <p>Actions are associated with combinations of facilities and priorities. 
        They specify what to do with the actual log messages that match a given 
        combination as shown below: </p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126">&nbsp;</td>
    <td> 
      <table 0 cellspacing=0 cellpadding=4 width=750order="1">
        <tr> 
          <td width="34%" valign="TOP" bgcolor="#ccddff" align="LEFT"> <b> 
            <p>Action (example) 
            </b></td>
          <td width="66%" valign="TOP" bgcolor="#ccddff" align="LEFT"> <b> 
            <p>Description 
            </b></td>
        </tr>
        <tr> 
          <td width="34%" valign="TOP"> 
            <p>/dev/console 
          </td>
          <td width="66%" valign="TOP"> 
            <p>Send messages to devices 
          </td>
        </tr>
        <tr> 
          <td width="34%" valign="TOP"> 
            <p>/var/adm/messages 
          </td>
          <td width="66%" valign="TOP"> 
            <p>Write messages to files 
          </td>
        </tr>
        <tr> 
          <td width="34%" valign="TOP"> 
            <p>@ loghost 
          </td>
          <td width="66%" valign="TOP"> 
            <p>Forward messages to a loghost 
          </td>
        </tr>
        <tr> 
          <td width="34%" valign="TOP"> 
            <p>fred,user1 
          </td>
          <td width="66%" valign="TOP"> 
            <p>Send messages to users 
          </td>
        </tr>
        <tr> 
          <td width="34%" valign="TOP"> 
            <p>* 
          </td>
          <td width="66%" valign="TOP"> 
            <p>Send messages to all logged-in users 
          </td>
        </tr>
      </table>
    <p>&nbsp;</p></td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Understand protection mechanisms for log files.</p>
      </font></b> 
      <p> </p>
      <p>Different approaches are available to provide adequate protection for 
        collected messages: </p>
      <ul>
        <li>Forward a set of specified messages to a loghost, which provides additional 
          security for the stored messages. </li>
        <li>Write a set of specified messages to a write-once medium like a WORM 
          (write once, read many) device to avoid any corruption or manipulation, 
          which might include the deletion, insertion, or change of any single 
          message. </li>
        <li>Write a set of specified messages to a printer to have a paper trail 
          of the most important messages.</li>
      </ul>
    </td>
  </tr>
  <tr valign="top"> 
    <td colspan="2"> 
      <hr size="1">
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126"><b><font face="Arial" size=3>Define the appropriate data storage location</font></b></td>
    <td> 
      <p>Before establishing the configuration, you need to decide which messages 
        are stored in what files, on what hosts, and what other actions you want 
        to initiate. You need to address two situations: </p>
      <ul>
        <li>Local hosts store some messages for normal system administration purposes 
          and forward any message to a central loghost for monitoring and added 
          security. On local systems, the directory <font face="Courier New" size=3>/var/adm/</font> 
          is used to store log message files. </li>
        <li>A central loghost stores all messages based on the logging policies. 
          On loghosts, the directory <font face="Courier New" size=3>/var/log/</font> 
          is used to store log message files. </li>
      </ul>
      <p>Although these situations might be quite different, the same clear and 
        simple set of rules can be applied throughout the entire network. The 
        following items describe a policy to handle various log messages in a 
        consistent way: </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Display important information on the console.</p>
      </font></b> 
      <p> </p>
      <p>The following messages should be written to the console: </p>
      <ul>
        <li>all messages with priority "err" or higher </li>
        <li>all messages with priority "notice" for the more critical facilities 
          "kern" and "mail" </li>
      </ul>
      <p>In addition, all messages from daemons ("daemon") and the authentication 
        components ("auth") should be displayed (this implies priority "debug" 
        or higher). </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Collect all messages for further processing.</p>
      </font></b> 
      <p> </p>
      <p>One file should be used to collect all important log messages. This file 
        is then used as an input source for other programs like swatch (<a href="i042.01.html">&quot;Installing, 
        configuring and using swatch to analyze log messages on systems running 
        Solaris 2.x&quot;</a>) or logsurfer (<a href="i042.02.html">&quot;Installing, 
        configuring, and using logsurfer on systems running Solaris 2.x&quot;</a>). 
        The file name used for this file is usually <font face="Courier New" size=3>messages</font>. 
      </p>
      <p>All messages should be written to a single file if they are priority 
        "err" or higher. For the facilities "auth", "daemon", "mark", and "kern", 
        all messages with priority "debug" and higher should be saved to the same 
        file. In addition, the facilities "user" and "mail" should also be saved 
        there if the message has priority "warning" or higher. </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Collect messages separately for important facilities.</p>
      </font></b> 
      <p> </p>
      <p>All messages for more important facilities like "lpr", "mail", "daemon", 
        and "auth" are written to separate files to produce a complete chronology 
        of events for these facilities. The file names used for these files are 
        usually the name of the facility with the extension <font face="Courier New" size=3>.log</font>, 
        e.g., <font face="Courier New" size=3>daemon.log</font>. </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td> 
      <p><b><font face="Arial" size=3 color="#008000">Forward all messages to 
        a central loghost.</font></b></p>
      <p>All messages should be sent to a central loghost to provide consistent 
        processing of all messages for all local hosts. On the loghost, all messages 
        are handled as described above. </p>
      <p>All messages forwarded to the loghost should be written to disk to build 
        a complete picture of all events in one location. This assumes that there 
        is sufficient disk space to do so. </p>
      <p>It is not possible to differentiate between local and non-local messages. 
        As a result, the rules stated above apply to both categories.</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td colspan="2"> 
      <hr size="1">
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126"><b><font face="Arial">Prepare files to store log messages</font></b></td>
    <td>You need to create and configures files that reflect the actions you intend 
      for storage of logging messages. </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td> 
      <p> </p>
      <b><font face="Arial" size=3 color="#008000"> 
      <p>Create the necessary files to store different log messages.</p>
      </font></b> 
      <p> </p>
      <p>You need to manually create log files and directories before their first 
        use if they do not already exist. Existing files should be rotated so 
        that all log files start at the same time and are consistent with one 
        another. This is especially important if the same messages can be written 
        to two or more files.</p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Check permissions of log files and directories used to store log files.</p>
      </font></b> 
      <p> </p>
      <p>You should restrict access to log files and their associated directories. 
        Only system and network administrators should have read access. You should 
        limit write access to "root" (<font face="Courier New" size=3>syslogd</font> 
        runs with root privileges).</p>
      <p>&nbsp; </p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Routinely rotate all log files.</p>
      </font></b> 
      <p> </p>
      <p>Ensure that log files are routinely rotated. This prevents the consumption 
        of all available disk space with historical and outdated messages. See 
        the implementation details on rotating log files (<a href="i041.09.html">&quot;Using 
        newslog to rotate files containing logging messages on systems running 
        Solaris 2.x&quot;</a>) for more information. </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td> 
      <p><b><font color="#008000" face="Arial" size="3">Set up other selected 
        mechanisms to deal with log messages.</font></b></p>
      <p>If specific protection measures are required (e.g., print a subset of 
        all log messages, write the messages on a write-once medium like a WORM 
        drive), these should be initiated. Implementation details are very dependent 
        on the selected mechanisms, so they are not addressed here. </p>
    </td>
  </tr>
  <tr valign="top"> 
    <td colspan="2"> 
      <hr size="1">
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126"><b><font face="Arial">Prepare and use the log files' configuration</font></b></td>
    <td> 
      <p>The next step is to set up your configuration files. Small systems typically 
        have one configuration file for both the local hosts and the loghost. 
        The risk in this approach is if one local host is compromised, the intruder 
        can also determine the setup of the loghost by analyzing the configuration 
        file. Two examples are provided that reflect the recommended setup. The 
        rules consist of facility-priority combinations and an action separated 
        by a special character (not a blank). More details on additional configurations 
        are available from the man page <font face="Courier New" size=3>syslog.conf</font> 
        (4). </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Prepare the hostname for the loghost.</p>
      </font></b> 
      <p> </p>
      <p>Implementing the rule stating that all messages are to be forwarded to 
        a loghost relies on setting the name <font face="Courier New" size=3>loghost</font> 
        as the hostname. This is accomplished by providing <font face="Courier New" size=3>loghost 
        </font>as the alias or hostname within the file <font face="Courier New" size=3>/etc/hosts</font> 
        via the domain name system (DNS) or other mechanisms such as the network 
        information service (NIS). </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td> 
      <p><font color="#008000" face="Arial" size="3"><b>Prepare the configuration 
        file for local hosts</b></font><b><font face="Arial" size=3 color="#008000">.</font></b></p>
      <p> </p>
      <p>The configuration file <font face="Courier New" size=3>/etc/syslog.conf</font> 
        is as follows: </p>
      <font face="Courier New" size=2> 
      <pre>#
# syslog configuration file (local hosts)
#</pre>
      <pre># output to console</pre>
      <pre>*.err;mail,kern.notice;daemon,auth.debug;user.info   /dev/console</pre>
      <pre># output to local file "messages" for automatic log file analysis</pre>
      <pre>*.err;auth,daemon,mark,kern.debug;mail,user.notice   /var/adm/messages</pre>
      <pre># output to local files for archiving messages of potential interest</pre>
      <pre>auth.debug    /var/adm/auth.log
daemon.debug  /var/adm/daemon.log
lpr.debug     /var/adm/lpr.log
mail.debug    /var/adm/mail.log</pre>
      <pre># forward to loghost</pre>
      <pre>mark.debug;*.debug   @loghost</pre>
      <pre># end of /etc/syslog.conf</pre>
      </font> </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td> 
      <p><b><font color="#008000" size="3" face="Arial, Helvetica, sans-serif">Prepare 
        the configuration file for the loghost.</font></b></p>
      <p> </p>
      <p>The configuration file <font face="Courier New" size=3>/etc/syslog.conf</font> 
        is as follows: </p>
      <font face="Courier New" size=2> 
      <pre>#
# syslog configuration file (loghost)
#</pre>
      <pre># output to console</pre>
      <pre>*.err;mail,kern.notice;daemon,auth.debug;user.info/dev/console</pre>
      <pre># output to local file "messages" for automatic log file 
analysis (logsurfer)</pre>
      <pre>*.err;auth,daemon,mark,kern.debug;mail,user.notice/var/log/messages</pre>
      <pre># output to local files for archiving messages of potential interest</pre>
      <pre>auth.debug  &#9;/var/log/auth.log
daemon.debug        /var/log/daemon.log
lpr.debug    &#9;/var/log/lpr.log
mail.debug  &#9;/var/log/mail.log
news.debug  &#9;/var/log/news.log
uucp.debug  &#9;/var/log/uucp.log
user.debug  &#9;/var/log/user.log</pre>
      <pre># end of /etc/syslog.conf

</pre>
      </font></td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td> 
      <p><b><font color="#008000" face="Arial" size="3">Inform the current process 
        about the configuration change.</font></b></p>
      <p>The signal <font face="Courier New" size=3>SIGHUP</font> must be sent 
        to an executing process to initiate the use of an updated configuration 
        file. In addition, the process closes all previously opened log files 
        and opens the newly specified log files, as follows: </p>
      <font face="Courier New" size=2> 
      <p># kill -SIGHUP `cat /etc/syslogd.pid`</p>
      </font></td>
  </tr>
  <tr valign="top"> 
    <td colspan="2"> 
      <hr size="1">
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126"><b><font face="Arial">Additional steps</font></b> </td>
    <td>
      <p>The steps above have described the process for handling log messages, 
        implementing them in a <font face="Courier" size=3>syslog </font>configuration, 
        and activating the configuration. Additional steps are needed to fully 
        satisfy security requirements. </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Make use of mark messages (time stamps).</p>
      </font></b> 
      <p> </p>
      <p>Mark messages should be turned on to make it easier to analyze the timeline 
        of messages and to identify possible gaps within the log archives. </p>
      <p>Mark messages are generated by <font face="Courier" size=3>syslogd </font>after 
        a predefined time period. Other periods can be specified during the <font face="Courier New" size=3>syslogd 
        </font>startup. </p>
      <p>To activate mark messages, you need to edit the script file that starts 
        <font face="Courier New" size=3>syslogd</font><font size=3>.</font> The 
        file</p>
      <p><font face="Courier New" size=3>/etc/init.d/syslog</font> must be edited 
        within the "start" section. In the following example, <font face="Courier New" size=3>syslogd</font> 
        is called to set a mark interval of 10 minutes, as follows: </p>
      <pre> <font face="Courier New" size=2>/usr/sbin/syslog -m 10 1&gt;/dev/console  2&gt;&amp;1</font></pre>
      <p> If only <font face="Courier New" size=3>-m</font> is stated, the default 
        interval is 20 minutes. </p>
      <p>Thereafter, the current <font face="Courier New" size=3>syslogd </font>must 
        be stopped and restarted by the following command sequence: </p>
      <font face="Courier New" size=2> 
      <pre># /etc/init.d/syslog  stop
# /etc/init.d/syslog  start</pre>
      </font> 
      <p>All messages sent between stopping and starting <font face="Courier New" size=3>syslogd</font> 
        will be lost. </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"><b><font face="Arial"></font></b></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Test the configuration.</p>
      </font></b> 
      <p> </p>
      <p> A program called <font face="Courier New" size=3>logger</font> (1) is 
        used to test the configuration. Any facility and priority combination 
        can be specified on the command line, as follows: </p>
      <p> <font face="Courier New" size=2># /usr/ucb/logger -p mail.warning -t 
        sendmail "this is the test for mail.warning"</font></p>
      <p>This sets the facility set to "mail" and the priority to "warning". The 
        message is logged as coming from the program "sendmail".</p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align="right"><b><font face="Arial"></font></b></td>
    <td> 
      <p><b><font color="#008000" face="Arial" size="3">Protect the integrity 
        of the configuration files.</font></b></p>
      <p>An authoritative copy of the configuration files should be transferred 
        to a write-protected medium to protect it from being compromised. The 
        configuration files should be included in any integrity checking procedure 
        such as the use of <a href="i002.02.html"> Tripwire.</a> </p>
     
 <p>Integrity checking procedures that compare cryptographic checksums are 
        of limited use for log files due to the regular addition of new records. 
        It is more useful to compare access permissions, file mode settings, and 
        the user id of the owner for the current log files with those that are 
        part of your previously stored expected state.</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td colspan="2"> 
      <hr size="1">
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126"><b><font face="Arial"> 
      <p>Additional information</p>
      </font></b> </td>
    <td>The following paragraphs discuss additional areas that need to be considered. 
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align=right></td>
    <td> 
      <p><font face="Arial" size=3 color="#008000"><b>Provide sufficient disk 
        space</b></font><font color="#008000">.</font></p>
      <p> </p>
      <p>You need to provide sufficient disk space to be able to store all desired 
        log messages. The required space is dependent on the configuration and 
        system disk utilization. You need to review the size of log files after 
        establishing the initial configuration and after a series of configuration 
        changes. We recommend that you manually control the size of the log files 
        over a period of time so that you can adjust as necessary. </p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align=right></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>Keep denial-of-service attacks in mind.</p>
      </font></b> 
      <p> </p>
      <p>You need to plan for denial-of-service attacks. An intruder can create 
        messages that consume all available disk space. After all available disk 
        space is used, no new messages can be stored and, as a result, you may 
        lose the intruder's attack pattern as well as critical messages. </p>
      <p>Other services can be compromised to fill the available disk space so 
        the syslog files should be stored in a separate partition to avoid any 
        confusion or overlap with other services (e.g., the spool directories 
        for printers, email servers). </p>
      <p>Another type of denial-of-service attack can occur when the processing 
        load on a system generating log messages is high, possibly resulting in 
        the system being unable to store or forward log messages to a loghost. 
        You need to consider resource loading for both systems generating log 
        messages and systems serving as loghosts. You should minimize the placement 
        of other services on servers performing as loghosts. </p>
      <p>Even if sufficient system resources are available, log messages might 
        not be forwarded to the loghost. The <font face="Courier New" size=3>syslogd 
        </font>protocol is based on the UDP (User Datagram Protocol) network service. 
        Network denial-of-service attacks can result in single log message packets 
        not reaching the loghost with no notification to the generating host.</p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align=right></td>
    <td><b><font face="Arial" size=3 color="#008000"> 
      <p>There is no authentication of log messages.</p>
      </font></b> 
      <p> </p>
      <p>Access to the <font face="Courier New" size=3>syslogd </font>process 
        should be prohibited to protect against messages created by external network 
        users. This can be accomplished by filtering packets at the interface 
        between any public network (e.g., the Internet) and the local network. 
        There is no need to accept any syslog message from outside the internal 
        network. Filtering should apply to any internal destination address. </p>
      <p>Local users are usually able to create arbitrary log messages using utilities 
        like <font face="Courier New" size=3>logger </font>(1). There is no protection 
        against this threat when using syslog.</p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td width="126" align=right></td>
    <td> 
      <p><b><font color="#008000" face="Arial" size="3">Identify new syslog messages.</font></b></p>
      <p>Every application produces different messages in varying formats when 
        using syslog. As a result, it is usually very difficult to know all possible 
        messages (their format, the priority and facility) in advance. We recommend 
        initially storing every log message produced by a given application and 
        reviewing the results to become familiar with the output. Once this has 
        been accomplished, you can usually identify those messages that are most 
        meaningful for detecting signs of intrusion through the use of application 
        program documentation, man pages, or source code (if available). </p>
      <p>If you develop new application programs, you need to include the format 
        and meaning of each log message in the design documentation. </p>
      <p>Tools such as swatch (<a href="i042.01.html">&quot;Installing, configuring 
        and using swatch 2.2 to analyze log messages on systems runing Solaris 
        2.x&quot;</a>) or logsurfer (<a href="i042.02.html">&quot;Installing, 
        configuring, and using logsurfer on systems running Solaris 2.x&quot;</a>) 
        can be configured to watch for specific messages and act upon them. Known 
        expected messages can be stored in a database for comparison purposes. 
        Unknown messages can be written to a separate file for later review.</p>
    </td>
  </tr>
  <tr valign="top"> 
    <td colspan="2"> 
      <hr size="1">
    </td>
  </tr>
</table>


</body>
</html>














